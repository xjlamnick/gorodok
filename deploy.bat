@echo off
chcp 65001 >nul
cls

echo.
echo ============================================================
echo   –û–ù–û–í–õ–ï–ù–ù–Ø –¢–ê –ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ø –ù–ê GITHUB
echo ============================================================
echo.

if not exist "sales.xlsx" (
    echo ‚ùå –§–∞–π–ª sales.xlsx –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ!
    echo    –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å, —â–æ —Ñ–∞–π–ª –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ü—ñ–π –ø–∞–ø—Ü—ñ
    echo.
    pause
    exit /b 1
)

echo üìä –ö—Ä–æ–∫ 1/4: –û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ Excel...
python update_data.py sales.xlsx

if errorlevel 1 (
    echo.
    echo ‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ –¥–∞–Ω–∏—Ö!
    pause
    exit /b 1
)

echo.
echo üì¶ –ö—Ä–æ–∫ 2/4: –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª—ñ–≤...
git add sales-data.json index.html

if errorlevel 1 (
    echo ‚ùå –ü–æ–º–∏–ª–∫–∞ git. –ú–æ–∂–ª–∏–≤–æ git –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ?
    pause
    exit /b 1
)

echo üíæ –ö—Ä–æ–∫ 3/4: –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–º—ñ–Ω...
for /f "tokens=2-4 delims=/ " %%a in ('date /t') do (set mydate=%%c-%%b-%%a)
for /f "tokens=1-2 delims=/:" %%a in ('time /t') do (set mytime=%%a:%%b)
git commit -m "–û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö: %mydate% %mytime%"

echo üöÄ –ö—Ä–æ–∫ 4/4: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub...
git push

if errorlevel 1 (
    echo.
    echo ‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ –Ω–∞ GitHub!
    echo.
    echo üí° –ú–æ–∂–ª–∏–≤—ñ –ø—Ä–∏—á–∏–Ω–∏:
    echo    ‚Ä¢ –ù–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ git remote
    echo    ‚Ä¢ –ü–æ—Ç—Ä—ñ–±–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è
    echo    ‚Ä¢ –ù–µ–º–∞—î —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è
    echo.
    pause
    exit /b 1
)

echo.
echo ============================================================
echo   ‚úÖ –£–°–ü–Ü–•!
echo ============================================================
echo.
echo üì± –í–∞—à —Å–∞–π—Ç –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è –Ω–∞ GitHub Pages
echo ‚è±Ô∏è  –ó–∞—á–µ–∫–∞–π—Ç–µ 1-2 —Ö–≤–∏–ª–∏–Ω–∏, –ø–æ—Ç—ñ–º –æ–Ω–æ–≤—ñ—Ç—å —Å—Ç–æ—Ä—ñ–Ω–∫—É
echo.
echo üîó –ü–æ—Å–∏–ª–∞–Ω–Ω—è:
echo    https://–≤–∞—à-username.github.io/sales-team/
echo.
echo ============================================================
pause
